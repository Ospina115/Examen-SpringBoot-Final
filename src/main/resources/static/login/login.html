<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD Ciudades</title>
</head>
<body>
    <h1>CRUD Ciudades</h1>
    <div>
        <h2>Lista de Ciudades</h2>
        <ul id="ciudades-list"></ul>
    </div>
    <div>
        <h2>Agregar Ciudad</h2>
        <input type="text" id="nombre-ciudad" placeholder="Nombre de la ciudad" />
        <button onclick="createCiudad()">Agregar</button>
    </div>
    <div>
        <h2>Actualizar Ciudad</h2>
        <input type="number" id="id-ciudad" placeholder="ID de la ciudad" />
        <input type="text" id="nuevo-nombre-ciudad" placeholder="Nuevo nombre de la ciudad" />
        <button onclick="updateCiudad()">Actualizar</button>
    </div>
    <div>
        <h2>Eliminar Ciudad</h2>
        <input type="number" id="eliminar-id-ciudad" placeholder="ID de la ciudad" />
        <button onclick="deleteCiudad()">Eliminar</button>
    </div>

    <script>
        const apiUrl = 'http://localhost:8080/api/v1/paises';

        // Función para listar ciudades
        async function listCiudades() {
            const response = await fetch(apiUrl);
            const ciudades = await response.json();
            const ciudadesList = document.getElementById('ciudades-list');
            ciudadesList.innerHTML = '';
            ciudades.forEach(ciudad => {
                const li = document.createElement('li');
                li.textContent = ciudad.nombre; // Cambia 'nombre' si tu objeto tiene otro campo
                ciudadesList.appendChild(li);
            });
        }

        // Función para crear una nueva ciudad
        async function createCiudad() {
            const nombre = document.getElementById('nombre-ciudad').value;
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ nombre }) // Cambia según la estructura de tu objeto
            });
            if (response.ok) {
                listCiudades(); // Actualiza la lista
            } else {
                alert('Error al agregar ciudad');
            }
        }

        // Función para actualizar una ciudad
        async function updateCiudad() {
            const id = document.getElementById('id-ciudad').value;  
            const nuevoNombre = document.getElementById('nuevo-nombre-ciudad').value;
            const response = await fetch(`${apiUrl}/${id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ nombre: nuevoNombre }) // Cambia según la estructura de tu objeto
            });
            if (response.ok) {
                listCiudades(); // Actualiza la lista
            } else {
                alert('Error al actualizar ciudad');
            }
        }

        // Función para eliminar una ciudad
        async function deleteCiudad() {
            const id = document.getElementById('eliminar-id-ciudad').value;
            const response = await fetch(`${apiUrl}/${id}`, {
                method: 'DELETE'
            });
            if (response.ok) {
                listCiudades(); // Actualiza la lista
            } else {
                alert('Error al eliminar ciudad');
            }
        }

        // Carga inicial de ciudades
        listCiudades();
    </script>
</body>
</html>